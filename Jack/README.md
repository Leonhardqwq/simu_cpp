# 使用说明

## 使用方法

在excel中键入场景参数并保存文件，运行read_info.exe文件，待弹窗消失后运行主程序。  
- 仅绿色单元格可编辑参数，红色单元格为提示语或弃用参数
- 主程序运行时，括号内数字代表测试进度，括号后数字代表截至目前测得的破阵率
- 主程序运行结束后，会依次输出：最终破阵率、破阵次数和总测试次数、破阵率的95%置信区间（Wilson CI）

## 更新内容
### 底层优化
- 使用C++重写，利用多线程和O2优化大幅加快测试速度，轻松实现千万次测试。
### 机制判定
修复了诸多不符合原生机制的bug：
- 小丑机制：
  - 血量降至临界值以下所需伤害值由334更正为335。
  - 所有坐标计算使用C++原生flaot数据类型，减少浮点数误差。
  - 修复了冻结/减速倒计时的1cs问题，修复了解减、短时间连用两冰存在的问题。
- 植物机制：
  - 完全复现了植物的触发、攻击机制，修复了小丑在触发范围内、攻击范围外异常受伤的问题。
  - 修复了植物向左攻击范围无限的问题。
- 交互机制：
  - 修正了帧内判定顺序问题，严格按照植物，僵尸，子弹顺次进行相关判定。
  - 修正了判定时的结算问题，在本帧未完成坐标更新前使用上一帧坐标，在完成后才使用本帧坐标。


### 参数更新
- `被炸植物类型`参数增加了炮，并且在屋顶的判定正常。
- 新增锁部分随机数功能，测试0破阵率：
  - 新增参数`锁僵尸出生点与冻结倒计时`，设置`最快`时，锁最左出生点和最短冻结时间，`最慢`同理。
  - 新增参数`锁植物攻击间隔`，设置`最快`时，锁最短攻击间隔，`最慢`同理。
- 新增灰烬相关的诸多参数，可以更精准地测试复杂情景：
  - 新增参数`植物可伤时机`，默认0，代表测试常驻植物炸率，根据需求设置，可以测试核弹炸率等情景。
  - 新增参数`灰烬信息列表`，可填入多次灰烬的信息，具体参数包括
    - `灰烬时机`
    - `灰烬类型`可设`卡`或`炮`，并符合帧内判定顺序。
    - 新增参数`灰烬范围`，填入灰烬范围的左右界（包含端点），当小丑坐标(int)落于界内且可伤时，才可受灰烬。

- 删除了`时间上限`参数，程序自动计算适合的时间上限。
- 删除了`垫材`参数，不再支持垫材相关测试。


## 特殊假设
- 假设被炸植物左侧种满了植物，程序测试的是阵型植物被炸的概率，不考虑小丑经过被炸植物后再爆炸且没有其他植物被炸的情况。
- 假设小丑不受任何植物的阻拦，其不会因本行存在被炸植物或大喷而停止移动。
- 假设非永动植物在触发激活后始终为永动状态。

---

如有问题请联系开发者：b站 Leonhard_qwq https://space.bilibili.com/171987343